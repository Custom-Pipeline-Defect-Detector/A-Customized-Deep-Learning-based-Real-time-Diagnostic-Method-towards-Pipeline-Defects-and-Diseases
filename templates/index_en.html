<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pipeline Detection System</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="static/js/vue.js"></script>
    <link rel="stylesheet" href="static/css/index.css">
    <script src="static/js/index.js"></script>
    <script src="static/js/require.js"></script>
    <script type="text/javascript" src="static/js/echarts.min.js"></script>
    <script src="static/js/jquery-3.5.1.min.js"></script>
</head>

<body>
<div id="container" align="center" style="width: 100%">
    <el-container style="width: auto; border: 1px solid #eee;height: 900px">
        <el-header style="text-align: center;height: auto; font-size:x-large;align-items: center">
            <el-menu :default-active="activeIndex" class="el-menu-demo" mode="horizontal" @select="handleSelect">
                <el-menu-item>
                    <el-link :underline="false" href="{{ url_for("refresh") }}"
                             style="font-weight: bold;color: #3a8ee6;font-size: large;">Pipeline Detection
                        System
                    </el-link>
                </el-menu-item>
                <el-submenu index="3" style="float: right">
                    <template slot="title">
                        English
                    </template>
                    <el-link :underline="false" href="{{ url_for("index_cn") }}">
                        <el-menu-item index="3-1">
                            中文
                        </el-menu-item>
                    </el-link>
                </el-submenu>
                <el-submenu index="1" style="float: right">
                    <template slot="title">
                        Simplexity Lab
                    </template>
                    <el-menu-item index="2">Developing1</el-menu-item>
                    <el-menu-item index="2-2">Developing2</el-menu-item>
                    <el-menu-item index="2-3">Developing3</el-menu-item>
                </el-submenu>
                <el-menu-item index="2" style="float: right">
                    <div>
                        <el-avatar
                                src="static/images/avatar.png"></el-avatar>
                    </div>
                </el-menu-item>
            </el-menu>
        </el-header>
        <el-container style=" ">
            <el-aside width="15%" style="background-color:rgb(238, 241, 246);">
                <el-menu :default-openeds="['1', '3']" style="text-align: left;height: 100%" background-color="#545c64"
                         text-color="#fff" active-text-color="#ffd04b">
                    <el-submenu index="1">
                        <template slot="title"><i class="el-icon-setting"></i>System Functions</template>
                        <el-menu-item-group>
                            <el-menu-item index="1">
                                <el-link :underline="false" href="{{ url_for("refresh") }}" style="color: #FFFFFF">
                                    <i class="el-icon-back"></i>Home Page
                                </el-link>
                            </el-menu-item>
                            <el-menu-item index="1">
                                <el-link :underline="false" @click="dialog = true" style="color: #FFFFFF"><i
                                        class="el-icon-s-operation"></i>Configuration
                                    Item
                                </el-link>
                            </el-menu-item>
                            <el-menu-item index="1">
                                <el-link :underline="false" href="{{ url_for("refresh") }}" style="color: #FFFFFF"><i
                                        class="el-icon-delete"></i>Clear Cache
                                </el-link>
                            </el-menu-item>
                            <el-menu-item index="1">
                                <el-link :underline="false" href="{{ url_for("neo4j_owl") }}" style="color: #FFFFFF"><i
                                        class="el-icon-orange"></i>Ontology Model
                                </el-link>
                            </el-menu-item>
                            <el-menu-item index="1">
                                <el-link :underline="false" href="http://localhost:7474/browser" style="color: #FFFFFF">
                                    <i
                                            class="el-icon-help"></i>Neo4j Database
                                </el-link>
                            </el-menu-item>
                            <el-menu-item index="1">
                                <el-link :underline="false" href="" style="color: #FFFFFF">
                                    <i class="el-icon-refresh"></i>Update Json
                                </el-link>
                            </el-menu-item>
                        </el-menu-item-group>
                    </el-submenu>
                </el-menu>
            </el-aside>
            <el-container width="85%">
                <el-container>
                    <el-main style="height: 100%;width: 70%" class="page_scroll">
                        <el-backtop target=".page_scroll" visibility-height="0"></el-backtop>
                        <el-alert
                                title="Instructions: (1) Upload images or videos by clicking or dragging; (2) Select a deep learning model, use default parameter configuration, or configure parameters by yourself, and click the detect button to detect pipeline defects; (3) Click the Get Repair Advice button to run Drools."
                                type="success"
                                :closable="false">
                        </el-alert>
                        <div style="text-align: center">
                            {% if upload_files_path %}
                                {# Original Image or Video #}
                                {# Video #}
                                {% if VIDEO_FLAG %}
                                    <el-divider>
                                        <el-tag>Original Video</el-tag>
                                    </el-divider>
                                    {% for upload_file_path in upload_files_path %}
                                        <video width="320" height="240" controls>
                                            <source src="{{ upload_file_path }}" type="video/mp4">
                                            <source src="{{ upload_file_path }}" type="video/ogg">
                                            <source src="{{ upload_file_path }}" type="video/webm">
                                            <object data="{{ upload_file_path }}" width="320" height="240">
                                                <embed src="{{ upload_file_path }}" width="320" height="240">
                                            </object>
                                        </video>
                                    {% endfor %}
                                    <el-divider>
                                        <el-tag>Key Frame Extraction</el-tag>
                                    </el-divider>
                                    <div align="center">
                                        <img src="static/keyFrames/frameDifferencesAndPeak.jpg" height="200">
                                    </div>
                                {% else %}
                                    {# Image #}
                                    <el-divider>
                                        <el-tag>Original Image</el-tag>
                                    </el-divider>
                                    <table align="center">
                                        <tr>
                                            {% for upload_file_path in upload_files_path %}
                                                <td>
                                                    <img src="{{ upload_file_path }}" width="200">
                                                </td>
                                            {% endfor %}
                                        </tr>
                                    </table>
                                {% endif %}
                                {# Detection Result #}
                                <el-divider>
                                    <el-tag type="success">Detection Result</el-tag>
                                </el-divider>
                                <table align="center">
                                    <tr>
                                        {% for identify_image in identify_images %}
                                            <td><a href="{{ identify_image }}" download="result.png"><img
                                                    src="{{ identify_image }}" alt=""
                                                    width="200"></a>
                                                <form action="/get_repairAdvice?i={{ loop.index }}" method="post">
                                                    <el-button icon="el-icon-thumb" id="button_advice"
                                                               native-type="submit">
                                                        Repair Suggestions
                                                    </el-button>
                                                </form>
                                            </td>
                                        {% endfor %}
                                    </tr>
                                </table>
                                <el-divider>
                                    <el-tag type="success">Repair Suggestions</el-tag>
                                </el-divider>
                                {# Repair Suggestions Table AJAX Refresh #}
                                <div align="center" id="repair_advice" class="repair_advice_module">
                                    <el-table
                                            :data="{{ advice_list }}"
                                            :row-class-name="tableRowClassName"
                                            stripe>
                                        <el-table-column
                                                prop="attribute"
                                                label="Attribute"
                                                width="420"
                                                align="center">
                                        </el-table-column>
                                        <el-table-column
                                                prop="value"
                                                label="Value"
                                                width="420"
                                                align="center">
                                        </el-table-column>
                                    </el-table>
                                </div>
                            {% else %}
                                {# Upload Image or Video #}
                                <div align="center">
                                    <div style="transform:translateY(35%);width: auto">
                                        <el-upload
                                                class="upload-demo"
                                                drag
                                                action="{{ url_for("upload") }}"
                                                multiple
                                                name="file"
                                                auto-upload>
                                            <i class="el-icon-upload"></i>
                                            <div class="el-upload__text">Drag files here, or<em> click upload</em></div>
                                        </el-upload>
                                    </div>
                                    <br>
                                    <div style="transform:translateY(60%)">
                                        <el-form action="{{ url_for("detect") }}" method="post"
                                                 style="width: 45%">
                                            <el-radio-group v-model="radio1">
                                                <el-radio-button label="YOLOv7" name="model_type"></el-radio-button>
                                                <el-radio-button label="YOLOv5" name="model_type"></el-radio-button>
                                                <el-radio-button label="YOLOX" name="model_type"></el-radio-button>
                                                <el-radio-button label="Faster R-CNN"
                                                                 name="model_type"></el-radio-button>
                                                <el-radio-button label="EfficientNet-YOLOv8" name="model_type"></el-radio-button>
                                            </el-radio-group>
                                            <div style="margin-top: 20px">
                                                <el-button type="success" icon="el-icon-caret-right"
                                                           native-type="submit"
                                                           @click="openFullScreen2">Detect
                                                </el-button>
                                            </div>
                                        </el-form>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    </el-main>
                    {# Configuration Drawer #}
                    {% if upload_files_path %}
                    {% else %}
                        <el-aside style="float: right;width:30%;height: auto;background-color: rgb(245,245,255)">
                            <div class="demo-drawer__content" align="left"
                                 style="width: auto;height:775px">
                                <div align="center" style="font-size: 30px">
                                    <el-link type="info" disabled>Configuration Item Settings</el-link>
                                </div>

                                <template>
                                    <el-tabs v-model="activeName" @tab-click="handleClick" type="card">
                                        <el-tab-pane label="YOLOv7" name="fifth">
                                            <div class="demo-drawer__content">
                                                <el-form ref="yolov5_form" :model="yolov5_form" label-width="30%"
                                                         action="{{ url_for("yolov57_configuration") }}"
                                                         method="Post">
                                                    <el-form-item label="Weights">
                                                        <el-upload
                                                                class="upload-demo"
                                                                action="{{ url_for("yolov57_configuration") }}"
                                                                name="yolov5_weights"
                                                                :on-preview="handlePreview"
                                                                :on-remove="handleRemove"
                                                                :before-remove="beforeRemove"
                                                                multiple
                                                                :limit="1"
                                                                :on-exceed="handleExceed"
                                                                :file-list="fileList"
                                                                :auto-upload="false">
                                                            <el-button size="small" type="primary">Click Upload
                                                            </el-button>
                                                        </el-upload>
                                                    </el-form-item>
                                                    <el-form-item label="Image Size">
                                                        <el-input v-model="yolov5_form.imgsz"
                                                                  name="imgsz" style="width: auto;"></el-input>
                                                    </el-form-item>
                                                    <el-form-item label="Confidence Threshold">
                                                        <el-input-number v-model="yolov5_form.conf_thres"
                                                                         :precision="2"
                                                                         :step="0.01"
                                                                         :max="1" :min="0"
                                                                         name="conf_thres"></el-input-number>
                                                    </el-form-item>
                                                    <el-form-item label="IoU Threshold">
                                                        <el-input-number v-model="yolov5_form.iou_thres"
                                                                         :precision="2"
                                                                         :step="0.01"
                                                                         :max="1" :min="0"
                                                                         name="iou_thres"></el-input-number>
                                                    </el-form-item>
                                                    <el-form-item label="Device">
                                                        <template>
                                                            <el-select v-model="yolov5_form.device"
                                                                       placeholder="Please select"
                                                                       name="device">
                                                                <el-option
                                                                        v-for="item in yolov5_form.device_option"
                                                                        :key="item.value"
                                                                        :label="item.label"
                                                                        :value="item.value">
                                                                </el-option>
                                                            </el-select>
                                                        </template>
                                                    </el-form-item>
                                                    <el-form-item label="Line Thickness">
                                                        <el-input-number v-model="yolov5_form.line_thickness"
                                                                         @change="handleChange"
                                                                         :min="1" :max="10"
                                                                         name="line_thickness"></el-input-number>
                                                    </el-form-item>
                                                    <el-form-item label="Hide Labels">
                                                        <template>
                                                            <el-select v-model="yolov5_form.hide_labels"
                                                                       placeholder="Please select"
                                                                       name="hide_labels">
                                                                <el-option
                                                                        v-for="item in yolov5_form.hide_labels_option"
                                                                        :key="item.value"
                                                                        :label="item.label"
                                                                        :value="item.value">
                                                                </el-option>
                                                            </el-select>
                                                        </template>
                                                    </el-form-item>
                                                    <el-form-item label="Hide Confidence">
                                                        <template>
                                                            <el-select v-model="yolov5_form.hide_conf"
                                                                       placeholder="Please select"
                                                                       name="hide_conf">
                                                                <el-option
                                                                        v-for="item in yolov5_form.hide_conf_option"
                                                                        :key="item.value"
                                                                        :label="item.label"
                                                                        :value="item.value">
                                                                </el-option>
                                                            </el-select>
                                                        </template>
                                                    </el-form-item>
                                                    <el-form-item>
                                                        <el-button type="primary" @click="" native-type="submit">
                                                            Submit
                                                        </el-button>
                                                        <el-button @click="dialog = false">Cancel</el-button>
                                                    </el-form-item>
                                                </el-form>
                                            </div>
                                        </el-tab-pane>
                                        <el-tab-pane label="YOLOv5" name="first">
                                            <div class="demo-drawer__content">
                                                <el-form ref="yolov5_form" :model="yolov5_form" label-width="30%"
                                                         action="{{ url_for("yolov57_configuration") }}"
                                                         method="Post">
                                                    <el-form-item label="Weights">
                                                        <el-upload
                                                                class="upload-demo"
                                                                action="{{ url_for("yolov57_configuration") }}"
                                                                name="yolov5_weights"
                                                                :on-preview="handlePreview"
                                                                :on-remove="handleRemove"
                                                                :before-remove="beforeRemove"
                                                                multiple
                                                                :limit="1"
                                                                :on-exceed="handleExceed"
                                                                :file-list="fileList"
                                                                :auto-upload="false">
                                                            <el-button size="small" type="primary">Click Upload
                                                            </el-button>
                                                        </el-upload>
                                                    </el-form-item>
                                                    <el-form-item label="Image Size">
                                                        <el-input v-model="yolov5_form.imgsz"
                                                                  name="imgsz" style="width: auto;"></el-input>
                                                    </el-form-item>
                                                    <el-form-item label="Confidence Threshold">
                                                        <el-input-number v-model="yolov5_form.conf_thres"
                                                                         :precision="2"
                                                                         :step="0.01"
                                                                         :max="1" :min="0"
                                                                         name="conf_thres"></el-input-number>
                                                    </el-form-item>
                                                    <el-form-item label="IoU Threshold">
                                                        <el-input-number v-model="yolov5_form.iou_thres"
                                                                         :precision="2"
                                                                         :step="0.01"
                                                                         :max="1" :min="0"
                                                                         name="iou_thres"></el-input-number>
                                                    </el-form-item>
                                                    <el-form-item label="Device">
                                                        <template>
                                                            <el-select v-model="yolov5_form.device"
                                                                       placeholder="Please select"
                                                                       name="device">
                                                                <el-option
                                                                        v-for="item in yolov5_form.device_option"
                                                                        :key="item.value"
                                                                        :label="item.label"
                                                                        :value="item.value">
                                                                </el-option>
                                                            </el-select>
                                                        </template>
                                                    </el-form-item>
                                                    <el-form-item label="Line Thickness">
                                                        <el-input-number v-model="yolov5_form.line_thickness"
                                                                         @change="handleChange"
                                                                         :min="1" :max="10"
                                                                         name="line_thickness"></el-input-number>
                                                    </el-form-item>
                                                    <el-form-item label="Hide Labels">
                                                        <template>
                                                            <el-select v-model="yolov5_form.hide_labels"
                                                                       placeholder="Please select"
                                                                       name="hide_labels">
                                                                <el-option
                                                                        v-for="item in yolov5_form.hide_labels_option"
                                                                        :key="item.value"
                                                                        :label="item.label"
                                                                        :value="item.value">
                                                                </el-option>
                                                            </el-select>
                                                        </template>
                                                    </el-form-item>
                                                    <el-form-item label="Hide Confidence">
                                                        <template>
                                                            <el-select v-model="yolov5_form.hide_conf"
                                                                       placeholder="Please select"
                                                                       name="hide_conf">
                                                                <el-option
                                                                        v-for="item in yolov5_form.hide_conf_option"
                                                                        :key="item.value"
                                                                        :label="item.label"
                                                                        :value="item.value">
                                                                </el-option>
                                                            </el-select>
                                                        </template>
                                                    </el-form-item>
                                                    <el-form-item>
                                                        <el-button type="primary" @click="" native-type="submit">
                                                            Submit
                                                        </el-button>
                                                        <el-button @click="dialog = false">Cancel</el-button>
                                                    </el-form-item>
                                                </el-form>
                                            </div>
                                        </el-tab-pane>
                                        <el-tab-pane label="YOLOX" name="fourth">
                                            <div class="demo-drawer__content">
                                                <el-form ref="yolox_form" :model="yolox_form" label-width="30%"
                                                         action="{{ url_for("yolox_configuration") }}"
                                                         method="Post">
                                                    <el-form-item label="Weights">
                                                        <el-upload
                                                                class="upload-demo"
                                                                action="{{ url_for("yolox_configuration") }}"
                                                                name="yolox_weights"
                                                                :on-preview="handlePreview"
                                                                :on-remove="handleRemove"
                                                                :before-remove="beforeRemove"
                                                                multiple
                                                                :limit="1"
                                                                :on-exceed="handleExceed"
                                                                :file-list="fileList"
                                                                :auto-upload="false">
                                                            <el-button size="small" type="primary">Click Upload
                                                            </el-button>
                                                        </el-upload>
                                                    </el-form-item>
                                                    <el-form-item label="Confidence">
                                                        <el-input-number v-model="yolox_form.conf"
                                                                         :precision="2"
                                                                         :step="0.01"
                                                                         :max="1" :min="0"
                                                                         name="conf"></el-input-number>
                                                    </el-form-item>
                                                    <el-form-item label="NMS">
                                                        <el-input-number v-model="yolox_form.nms"
                                                                         :precision="2"
                                                                         :step="0.01"
                                                                         :max="1" :min="0"
                                                                         name="nms"></el-input-number>
                                                    </el-form-item>
                                                    <el-form-item label="Size">
                                                        <el-input v-model="yolox_form.tsize"
                                                                  name="tsize" style="width: auto;"></el-input>
                                                    </el-form-item>
                                                    <el-form-item label="Device">
                                                        <template>
                                                            <el-select v-model="yolox_form.device"
                                                                       placeholder="Please select"
                                                                       name="device">
                                                                <el-option
                                                                        v-for="item in yolox_form.device_option"
                                                                        :key="item.value"
                                                                        :label="item.label"
                                                                        :value="item.value">
                                                                </el-option>
                                                            </el-select>
                                                        </template>
                                                    </el-form-item>
                                                    <el-form-item>
                                                        <el-button type="primary" @click="" native-type="submit">
                                                            Submit
                                                        </el-button>
                                                        <el-button @click="dialog = false">Cancel</el-button>
                                                    </el-form-item>
                                                </el-form>
                                            </div>
                                        </el-tab-pane>
                                        <el-tab-pane label="Faster R-CNN" name="second">
                                            <div class="demo-drawer__content2">
                                                <el-form ref="frcnn_form" :model="frcnn_form" label-width="30%"
                                                         action="{{ url_for("faster_rcnn_configuration") }}"
                                                         method="Post">
                                                    <el-form-item label="IoU">
                                                        <el-input-number v-model="frcnn_form.nms_iou"
                                                                         :precision="2" :step="0.01"
                                                                         :max="1" :min="0"
                                                                         name="nms_iou"></el-input-number>
                                                    </el-form-item>
                                                    <el-form-item label="Confidence">
                                                        <el-input-number v-model="frcnn_form.confidence"
                                                                         :precision="2"
                                                                         :step="0.01"
                                                                         :max="1" :min="0"
                                                                         name="confidence"></el-input-number>
                                                    </el-form-item>
                                                    <el-form-item label="Thickness">
                                                        <el-input-number v-model="frcnn_form.thickness"
                                                                         @change="handleChange"
                                                                         :min="1" :max="10"
                                                                         name="thickness"></el-input-number>
                                                    </el-form-item>
                                                    <el-form-item>
                                                        <el-button type="primary" @click="" native-type="submit">
                                                            Submit
                                                        </el-button>
                                                        <el-button @click="dialog = false">Cancel</el-button>
                                                    </el-form-item>
                                                </el-form>
                                            </div>
                                        </el-tab-pane>
                                        <el-tab-pane label="Key Frame Extraction" name="third">
                                            <div class="demo-drawer__content3">
                                                <el-form ref="keyframe_form" :model="keyframe_form"
                                                         label-width="30%"
                                                         action="{{ url_for("keyframe_configuration") }}"
                                                         method="Post">
                                                    <el-form-item label="Min Distance">
                                                        <el-input v-model="keyframe_form.Min_dist"
                                                                  name="Min_dist" style="width: auto;"></el-input>
                                                    </el-form-item>
                                                    <el-form-item label="Threshold">
                                                        <el-input-number v-model="keyframe_form.Thres"
                                                                         :precision="2"
                                                                         :step="0.01"
                                                                         :max="1" :min="0"
                                                                         name="Thres"></el-input-number>
                                                    </el-form-item>
                                                    <el-form-item label="Degree">
                                                        <el-input-number v-model="keyframe_form.Deg"
                                                                         @change="handleChange" :min="1"
                                                                         :max="10" name="Deg"></el-input-number>
                                                    </el-form-item>
                                                    <el-form-item>
                                                        <el-button type="primary" @click="" native-type="submit">
                                                            Submit
                                                        </el-button>
                                                        <el-button @click="dialog = false">Cancel</el-button>
                                                    </el-form-item>
                                                </el-form>
                                            </div>
                                        </el-tab-pane>
                                    </el-tabs>
                                </template>
                            </div>
                        </el-aside>
                    {% endif %}
                </el-container>
                <el-footer style="border: 1px solid #eee;color: #909399">
                    <el-descriptions title="" style="align-content:center;margin: 1% ;color: #909399">
                        <el-descriptions-item label="About us">Simplexity Lab</el-descriptions-item>
                        <el-descriptions-item label="Github">
                            <el-link type="info">https://github.com/Custom-Pipeline-Defect-Detector/A-Customized-Deep-Learning-based-Real-time-Diagnostic-Method-towards-Pipeline-Defects-and-Diseases</el-link>
                        </el-descriptions-item>
                    </el-descriptions>
                </el-footer>
            </el-container>
        </el-container>
    </el-container>
    <el-drawer
            title="Configuration Item Settings"
            :before-close="handleClose"
            :visible.sync="dialog"
            direction="rtl"
            custom-class="demo-drawer"
            ref="drawer"
    >
        {# Configuration Drawer #}
        <div class="demo-drawer__content" align="left" style="width: 90%">
            <template>
                <el-tabs v-model="activeName" @tab-click="handleClick" type="card">
                    <el-tab-pane label="YOLOv7" name="fifth">
                        <div class="demo-drawer__content">
                            <el-form ref="yolov5_form" :model="yolov5_form" label-width="100px"
                                     action="{{ url_for("yolov57_configuration") }}"
                                     method="Post">
                                <el-form-item label="Weights">
                                    <el-upload
                                            class="upload-demo"
                                            action="{{ url_for("yolov57_configuration") }}"
                                            name="yolov5_weights"
                                            :on-preview="handlePreview"
                                            :on-remove="handleRemove"
                                            :before-remove="beforeRemove"
                                            multiple
                                            :limit="1"
                                            :on-exceed="handleExceed"
                                            :file-list="fileList"
                                            :auto-upload="false">
                                        <el-button size="small" type="primary">Click Upload
                                        </el-button>
                                    </el-upload>
                                </el-form-item>
                                <el-form-item label="Image Size">
                                    <el-input v-model="yolov5_form.imgsz"
                                              name="imgsz"></el-input>
                                </el-form-item>
                                <el-form-item label="Confidence Threshold">
                                    <el-input-number v-model="yolov5_form.conf_thres"
                                                     :precision="2"
                                                     :step="0.01"
                                                     :max="1" :min="0"
                                                     name="conf_thres"></el-input-number>
                                </el-form-item>
                                <el-form-item label="IoU Threshold">
                                    <el-input-number v-model="yolov5_form.iou_thres"
                                                     :precision="2"
                                                     :step="0.01"
                                                     :max="1" :min="0"
                                                     name="iou_thres"></el-input-number>
                                </el-form-item>
                                <el-form-item label="Device">
                                    <template>
                                        <el-select v-model="yolov5_form.device"
                                                   placeholder="Please select"
                                                   name="device">
                                            <el-option
                                                    v-for="item in yolov5_form.device_option"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                            </el-option>
                                        </el-select>
                                    </template>
                                </el-form-item>
                                <el-form-item label="Line Thickness">
                                    <el-input-number v-model="yolov5_form.line_thickness"
                                                     @change="handleChange"
                                                     :min="1" :max="10"
                                                     name="line_thickness"></el-input-number>
                                </el-form-item>
                                <el-form-item label="Hide Labels">
                                    <template>
                                        <el-select v-model="yolov5_form.hide_labels"
                                                   placeholder="Please select"
                                                   name="hide_labels">
                                            <el-option
                                                    v-for="item in yolov5_form.hide_labels_option"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                            </el-option>
                                        </el-select>
                                    </template>
                                </el-form-item>
                                <el-form-item label="Hide Confidence">
                                    <template>
                                        <el-select v-model="yolov5_form.hide_conf"
                                                   placeholder="Please select"
                                                   name="hide_conf">
                                            <el-option
                                                    v-for="item in yolov5_form.hide_conf_option"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                            </el-option>
                                        </el-select>
                                    </template>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="" native-type="submit">
                                        Submit
                                    </el-button>
                                    <el-button @click="dialog = false">Cancel</el-button>
                                </el-form-item>
                            </el-form>
                        </div>
                    </el-tab-pane>
                    <el-tab-pane label="YOLOv5" name="first">
                        <div class="demo-drawer__content">
                            <el-form ref="yolov5_form" :model="yolov5_form" label-width="100px"
                                     action="{{ url_for("yolov57_configuration") }}"
                                     method="Post">
                                <el-form-item label="Weights">
                                    <el-upload
                                            class="upload-demo"
                                            action="{{ url_for("yolov57_configuration") }}"
                                            name="yolov5_weights"
                                            :on-preview="handlePreview"
                                            :on-remove="handleRemove"
                                            :before-remove="beforeRemove"
                                            multiple
                                            :limit="1"
                                            :on-exceed="handleExceed"
                                            :file-list="fileList"
                                            :auto-upload="false">
                                        <el-button size="small" type="primary">Click Upload
                                        </el-button>
                                    </el-upload>
                                </el-form-item>
                                <el-form-item label="Image Size">
                                    <el-input v-model="yolov5_form.imgsz"
                                              name="imgsz"></el-input>
                                </el-form-item>
                                <el-form-item label="Confidence Threshold">
                                    <el-input-number v-model="yolov5_form.conf_thres"
                                                     :precision="2"
                                                     :step="0.01"
                                                     :max="1" :min="0"
                                                     name="conf_thres"></el-input-number>
                                </el-form-item>
                                <el-form-item label="IoU Threshold">
                                    <el-input-number v-model="yolov5_form.iou_thres"
                                                     :precision="2"
                                                     :step="0.01"
                                                     :max="1" :min="0"
                                                     name="iou_thres"></el-input-number>
                                </el-form-item>
                                <el-form-item label="Device">
                                    <template>
                                        <el-select v-model="yolov5_form.device"
                                                   placeholder="Please select"
                                                   name="device">
                                            <el-option
                                                    v-for="item in yolov5_form.device_option"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                            </el-option>
                                        </el-select>
                                    </template>
                                </el-form-item>
                                <el-form-item label="Line Thickness">
                                    <el-input-number v-model="yolov5_form.line_thickness"
                                                     @change="handleChange"
                                                     :min="1" :max="10"
                                                     name="line_thickness"></el-input-number>
                                </el-form-item>
                                <el-form-item label="Hide Labels">
                                    <template>
                                        <el-select v-model="yolov5_form.hide_labels"
                                                   placeholder="Please select"
                                                   name="hide_labels">
                                            <el-option
                                                    v-for="item in yolov5_form.hide_labels_option"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                            </el-option>
                                        </el-select>
                                    </template>
                                </el-form-item>
                                <el-form-item label="Hide Confidence">
                                    <template>
                                        <el-select v-model="yolov5_form.hide_conf"
                                                   placeholder="Please select"
                                                   name="hide_conf">
                                            <el-option
                                                    v-for="item in yolov5_form.hide_conf_option"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                            </el-option>
                                        </el-select>
                                    </template>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="" native-type="submit">
                                        Submit
                                    </el-button>
                                    <el-button @click="dialog = false">Cancel</el-button>
                                </el-form-item>
                            </el-form>
                        </div>
                    </el-tab-pane>
                    <el-tab-pane label="YOLOX" name="fourth">
                        <div class="demo-drawer__content">
                            <el-form ref="yolox_form" :model="yolox_form" label-width="100px"
                                     action="{{ url_for("yolox_configuration") }}"
                                     method="Post">
                                <el-form-item label="Weights">
                                    <el-upload
                                            class="upload-demo"
                                            action="{{ url_for("yolox_configuration") }}"
                                            name="yolox_weights"
                                            :on-preview="handlePreview"
                                            :on-remove="handleRemove"
                                            :before-remove="beforeRemove"
                                            multiple
                                            :limit="1"
                                            :on-exceed="handleExceed"
                                            :file-list="fileList"
                                            :auto-upload="false">
                                        <el-button size="small" type="primary">Click Upload
                                        </el-button>
                                    </el-upload>
                                </el-form-item>
                                <el-form-item label="Confidence">
                                    <el-input-number v-model="yolox_form.conf"
                                                     :precision="2"
                                                     :step="0.01"
                                                     :max="1" :min="0"
                                                     name="conf"></el-input-number>
                                </el-form-item>
                                <el-form-item label="NMS">
                                    <el-input-number v-model="yolox_form.nms"
                                                     :precision="2"
                                                     :step="0.01"
                                                     :max="1" :min="0"
                                                     name="nms"></el-input-number>
                                </el-form-item>
                                <el-form-item label="Size">
                                    <el-input v-model="yolox_form.tsize"
                                              name="tsize"></el-input>
                                </el-form-item>
                                <el-form-item label="Device">
                                    <template>
                                        <el-select v-model="yolox_form.device"
                                                   placeholder="Please select"
                                                   name="device">
                                            <el-option
                                                    v-for="item in yolox_form.device_option"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                            </el-option>
                                        </el-select>
                                    </template>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="" native-type="submit">
                                        Submit
                                    </el-button>
                                    <el-button @click="dialog = false">Cancel</el-button>
                                </el-form-item>
                            </el-form>
                        </div>
                    </el-tab-pane>
                    <el-tab-pane label="Faster R-CNN" name="second">
                        <div class="demo-drawer__content2">
                            <el-form ref="frcnn_form" :model="frcnn_form" label-width="100px"
                                     action="{{ url_for("faster_rcnn_configuration") }}"
                                     method="Post">
                                <el-form-item label="IoU">
                                    <el-input-number v-model="frcnn_form.nms_iou"
                                                     :precision="2" :step="0.01"
                                                     :max="1" :min="0"
                                                     name="nms_iou"></el-input-number>
                                </el-form-item>
                                <el-form-item label="Confidence">
                                    <el-input-number v-model="frcnn_form.confidence"
                                                     :precision="2"
                                                     :step="0.01"
                                                     :max="1" :min="0"
                                                     name="confidence"></el-input-number>
                                </el-form-item>
                                <el-form-item label="Thickness">
                                    <el-input-number v-model="frcnn_form.thickness"
                                                     @change="handleChange"
                                                     :min="1" :max="10"
                                                     name="thickness"></el-input-number>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="" native-type="submit">
                                        Submit
                                    </el-button>
                                    <el-button @click="dialog = false">Cancel</el-button>
                                </el-form-item>
                            </el-form>
                        </div>
                    </el-tab-pane>
                    <el-tab-pane label="Key Frame Extraction" name="third">
                        <div class="demo-drawer__content3">
                            <el-form ref="keyframe_form" :model="keyframe_form"
                                     label-width="100px"
                                     action="{{ url_for("keyframe_configuration") }}"
                                     method="Post">
                                <el-form-item label="Min Distance">
                                    <el-input v-model="keyframe_form.Min_dist"
                                              name="Min_dist"></el-input>
                                </el-form-item>
                                <el-form-item label="Threshold">
                                    <el-input-number v-model="keyframe_form.Thres"
                                                     :precision="2"
                                                     :step="0.01"
                                                     :max="1" :min="0"
                                                     name="Thres"></el-input-number>
                                </el-form-item>
                                <el-form-item label="Degree">
                                    <el-input-number v-model="keyframe_form.Deg"
                                                     @change="handleChange" :min="1"
                                                     :max="10" name="Deg"></el-input-number>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="" native-type="submit">
                                        Submit
                                    </el-button>
                                    <el-button @click="dialog = false">Cancel</el-button>
                                </el-form-item>
                            </el-form>
                        </div>
                    </el-tab-pane>
                </el-tabs>
            </template>
        </div>
    </el-drawer>
</div>
</body>

<script>
    var Main = {
        data() {
            return {
                radio1: 'YOLOv7',
                activeName: 'first',
                dialog: false,
                loading: false,
                yolov5_form: {
                    imgsz: "(640,640)",
                    conf_thres: 0.25,
                    iou_thres: 0.45,
                    device_option: [{
                        value: '0',
                        label: '0'
                    }, {
                        value: '0,1,2,3',
                        label: '0,1,2,3'
                    }, {
                        value: 'cpu',
                        label: 'cpu'
                    }],
                    device: 'cpu',
                    line_thickness: 3,
                    hide_labels_option: [{
                        value: 'False',
                        label: 'False'
                    }, {
                        value: 'True',
                        label: 'True'
                    }],
                    hide_labels: "False",
                    hide_conf_option: [{
                        value: 'False',
                        label: 'False'
                    }, {
                        value: 'True',
                        label: 'True'
                    }],
                    hide_conf: "False"
                },
                yolox_form: {
                    conf: 0.30,
                    nms: 0.30,
                    device_option: [{
                        value: 'gpu',
                        label: 'gpu'
                    }, {
                        value: 'cpu',
                        label: 'cpu'
                    }],
                    device: 'cpu',
                    tsize: 640
                },
                frcnn_form: {
                    nms_iou: 0.3,
                    confidence: 0.5,
                    thickness: 1
                },
                keyframe_form: {
                    Min_dist: 30,
                    Thres: 0.3,
                    Deg: 2
                }
            }
        },
        methods: {
            submit_yolov57_configuration(e) {
                /* formData格式提交： */
                /*
                let formData = new FormData();
                for (var key in this.yolov5_form) {
                    formData.append(key, this.model[key]);
                }*/
                action_yolov5()
            }
        },
        methods: {
            onSubmit() {
                console.log('submit!');
            }
        },
        methods: {
            handleClose(done) {
                if (this.loading) {
                    return;
                }
                this.$confirm('Are you sure you want to submit the form?')
                    .then(_ => {
                        this.loading = true;
                        this.timer = setTimeout(() => {
                            done();
                            // 动画关闭需要一定的时间
                            setTimeout(() => {
                                this.loading = false;
                            }, 400);
                        }, 2000);
                    })
                    .catch(_ => {
                    });
            },
            cancelForm() {
                this.loading = false;
                this.dialog = false;
                clearTimeout(this.timer);
            }
        },
        methods: {
            get_advice(advice_list) {
                const loading = this.$loading({
                    lock: true,
                    text: 'Loading',
                    spinner: 'el-icon-loading',
                    background: 'rgba(0, 0, 0, 0.7)'
                });
                var repeat = 1;
                var advice = setInterval(function () {
                    if (repeat == 0) {
                        clearInterval(advice);
                    } else {
                        getadvice();
                        loading.close();
                        repeat--;
                    }
                }, 4000)
            },
            openFullScreen2() {
                const loading = this.$loading({
                    lock: true,
                    text: 'Loading',
                    spinner: 'el-icon-loading',
                    background: 'rgba(0, 0, 0, 0.7)'
                });
                setTimeout(() => {
                    loading.close();
                }, 99999999);
            }
        }
    }

    function action_yolov5() {
        $.ajax({
            url: '/yolov57_configuration',
            type: 'post',
            success: function () {
                console.log("success")
            }
        });
    }

    {#将修复建议表html在相应的div中显示#}

    function getadvice() {
        $.ajax({
            url: '/repair_advice_table',
            type: 'get',
            success: function (advice) {
                $('#repair_advice').html(advice);
            }
        });
    }

    var Ctor = Vue.extend(Main)
    new Ctor().$mount('#container')
</script>
<script type="text/javascript">
    {#查询所有#}
    var neo4j_data = [{{ neo4j_data|safe }}]
    var data1 = neo4j_data[0]['data']
    var links1 = neo4j_data[0]['links']
    console.log(data1)
    console.log(links1)
    var myChart1 = echarts.init(document.getElementById('container-echarts'));
    var categories1 = [{name: "Object"}, {name: "Property"}, {name: "Instance"}];
    option1 = {
        // 图的标题
        title: {
            text: 'Pipeline Ontology Model'
        },
        // 提示框的配置
        tooltip: {
            formatter: function (x) {
                return x.data.des;
            }
        },
        // 工具箱
        toolbox: {
            // 显示工具箱
            show: true,
            feature: {
                mark: {
                    show: true
                },
                // 还原
                restore: {
                    show: true
                },
                // 保存为图片
                saveAsImage: {
                    show: true
                }
            }
        },
        legend: [{
            // selectedMode: 'single',
            data: categories1.map(function (a) {
                return a.name;
            })
        }],
        series: [{
            type: 'graph', // 类型:关系图
            layout: 'force', //图的布局，类型为力导图
            symbolSize: 40, // 调整节点的大小
            roam: true, // 是否开启鼠标缩放和平移漫游。默认不开启。如果只想要开启缩放或者平移,可以设置成 'scale' 或者 'move'。设置成 true 为都开启
            edgeSymbol: ['circle', 'arrow'],
            edgeSymbolSize: [2, 10],
            edgeLabel: {
                normal: {
                    textStyle: {
                        fontSize: 20
                    }
                }
            },
            force: {
                repulsion: 2500,
                edgeLength: [10, 50]
            },
            draggable: true,
            lineStyle: {
                normal: {
                    width: 2,
                    color: '#4b565b',
                }
            },
            edgeLabel: {
                normal: {
                    show: true,
                    formatter: function (x) {
                        return x.data.name;
                    }
                }
            },
            label: {
                normal: {
                    show: true,
                    textStyle: {}
                }
            },

            // 数据
            data: data1,
            links: links1,
            categories: categories1,
        }]
    };

    myChart1.setOption(option1);

</script>
</html>
